{% extends 'base.html' %}
{% block content %}
<div class="row justify-content-center align-items-center min-vh-75">
  <div class="col-12 col-md-6 col-lg-5 col-xl-4">
    <div class="glass-card p-4 p-md-5 animate-scale-in">
      <div class="text-center mb-4">
        <div class="mb-3">
          <i class="fas fa-sign-in-alt fa-3x text-white opacity-75"></i>
        </div>
        <h2 class="title-responsive fw-bold mb-2">Welcome Back</h2>
        <p class="text-responsive opacity-75 mb-0">Sign in to your account</p>
      </div>
      
      <form method="post" class="animate-fade-in">
        {% csrf_token %}
        
        <div class="mb-4">
          <label class="form-label">
            <i class="fas fa-user me-2"></i>Username or Phone
          </label>
          <div class="field-wrapper">
            {{ form.username }}
          </div>
          {% if form.username.errors %}
            <div class="text-danger small mt-1">
              {% for error in form.username.errors %}
                <i class="fas fa-exclamation-circle me-1"></i>{{ error }}
              {% endfor %}
            </div>
          {% endif %}
        </div>
        
        <div class="mb-4">
          <label class="form-label">
            <i class="fas fa-lock me-2"></i>Password
          </label>
          <div class="field-wrapper password-wrapper position-relative">
            {{ form.password }}
            <button type="button" class="password-toggle position-absolute top-50 translate-middle-y" aria-label="Show password" title="Show password">
              <i class="fas fa-eye"></i>
            </button>
          </div>
          {% if form.password.errors %}
            <div class="text-danger small mt-1">
              {% for error in form.password.errors %}
                <i class="fas fa-exclamation-circle me-1"></i>{{ error }}
              {% endfor %}
            </div>
          {% endif %}
        </div>
        
        <div class="d-grid gap-3">
          <button type="submit" class="btn btn-primary btn-lg py-3 fw-bold">
            <i class="fas fa-sign-in-alt me-2"></i>
            Sign In
          </button>
        </div>
      </form>
      
      <div class="text-center mt-4 pt-3 border-top border-white-25">
        <p class="mb-0 text-white-75">
          Don't have an account? 
          <a href="{% url 'register' %}" class="text-white fw-semibold text-decoration-none">
            Create one here <i class="fas fa-arrow-right ms-1"></i>
          </a>
        </p>
      </div>
    </div>
  </div>
</div>

<style>
  .min-vh-75 { min-height: 75vh; }
  .border-white-25 { border-color: rgba(255,255,255,0.25)!important; }
  .text-white-75 { color: rgba(255,255,255,0.75); }
  .text-danger { color: #ff512f !important; }
  .glass-card form button.btn-primary { letter-spacing:.5px; }
  .glass-card i.opacity-75 { opacity:.65!important; }
  /* Ensure inputs stretch full width even if Django form lacks form-control class */
  .field-wrapper input { width:100%; display:block; padding:12px 16px; border-radius:14px; border:1px solid rgba(255,255,255,0.18); background:rgba(255,255,255,0.07); color:var(--text-color); }
  body.theme-light .field-wrapper input { background:rgba(0,0,0,0.04); border-color:rgba(0,0,0,0.15); color:#1d2433; }
  .field-wrapper input:focus { outline:none; border-color:var(--primary-grad-end); box-shadow:0 0 0 3px rgba(35,162,246,0.35); }
  body.theme-light .field-wrapper input:focus { box-shadow:0 0 0 3px rgba(35,162,246,0.25); background:#fff; }
  /* Password toggle */
  .password-wrapper input { padding-right:50px; }
  .password-toggle { right:8px; border:none; background:transparent; padding:0 6px; color:var(--text-color); display:inline-flex; align-items:center; justify-content:center; cursor:pointer; font-size:1rem; line-height:1; }
  .password-toggle:focus { outline:none; color:var(--primary-grad-end); }
  .password-toggle:hover { color:var(--primary-grad-end); }
  body.theme-light .password-toggle { color:#425267; }
  body.theme-light .password-toggle:hover { color:var(--primary-grad-end); }
  .password-toggle i { pointer-events:none; }
  .password-toggle.active i:before { content:"\f070"; } /* eye-slash when active (FontAwesome code) */
  @media (max-width: 768px){ .min-vh-75{min-height:auto; padding:2rem 0;} .glass-card{margin:0 16px;} }
</style>

<script>
  (function(){
    // Add form-control class if missing for consistent styling
    document.querySelectorAll('.field-wrapper input').forEach(inp => {
      if(!inp.classList.contains('form-control')) {
        inp.classList.add('form-control');
      }
    });
    const toggleBtn = document.querySelector('.password-toggle');
    if(toggleBtn){
      const pwdInput = toggleBtn.parentElement.querySelector('input');
      let visible = false;
      toggleBtn.addEventListener('click', () => {
        visible = !visible;
        pwdInput.setAttribute('type', visible ? 'text' : 'password');
        toggleBtn.classList.toggle('active', visible);
        toggleBtn.setAttribute('aria-label', visible ? 'Hide password' : 'Show password');
        toggleBtn.setAttribute('title', visible ? 'Hide password' : 'Show password');
      });
    }
  })();
</script>
{% endblock %}
